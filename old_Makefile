#SHELL := /bin/bash

#DATA_PATH = $(shell pwd)
#VERSION ?= $(shell git describe --tags --always --dirty)

#ifneq (,$(wildcard ./deployment/.env))
#    include deployment/.env
#    export
#	ENV_FILE_PARAM=deployment/.env
#endif

# default target is help
#.DEFAULT_GOAL := help

#help: ## Displays this help message
#	@awk 'BEGIN {FS = ":.*##"; printf "\nUsage:\n  make \033[36m<target>\033[0m\n"} /^[a-zA-Z_0-9-]+:.*?##/ { printf "  \033[36m%-15s\033[0m %s\n", $$1, $$2 } /^##@/ { printf "\n\033[1m%s\033[0m\n", substr($$0, 5) } ' $(MAKEFILE_LIST)

##@ Deployment

PROJDIR := $(realpath $(CURDIR))
#BUILDDIR := $(PROJDIR)/deployment

include backend/Makefile.lint


.PHONY: up-dev
up-dev:
	@echo "Starting development environment..."
	@${MAKE} -C ./deployment up-dev
	@echo "Development environment started"

.PHONY: down-dev
down-dev:
	@echo "Stopping development environment..."
	@${MAKE} -C ./deployment down-dev
	@echo "Development environment stopped"

.PHONY: down-dev-volumes
down-dev-volumes:
	@echo "Stopping development+VOLUMES environment..."
	@${MAKE} -C ./deployment down-dev-volumes
	@echo "Development+VOLUMES environment stopped"

.PHONY: up-backend
up-backend:
	@echo "Starting backend environment..."
	@${MAKE} -C ./deployment up-backend
	@echo "Backend environment started"

.PHONY: up-db
up-db:
	@echo "Starting DB environment..."
	@${MAKE} -C ./deployment up-db
	@echo "DB environment started"

.PHONY: up-locust
up-locust:
	@echo "Starting Locust performance testing..."
	@${MAKE} -C ./deployment up-locust
	@echo "Locust environment started"

.PHONY: down-locust
down-locust:
	@echo "Stopping Locust performance testing..."
	@${MAKE} -C ./deployment down-locust
	@echo "Locust environment started"